---
description: Java 18 äº 2022 å¹´ 3 æœˆ 22 æ—¥å‘å¸ƒï¼Œä½œä¸ºçŸ­æœŸæ”¯æŒç‰ˆæœ¬ï¼ˆé LTSï¼‰ï¼Œå¸¦æ¥äº† ç¼–ç ä¸€è‡´æ€§ã€å¼€å‘è€…å·¥å…·æ”¹è¿›ã€æ€§èƒ½ä¼˜åŒ– ç­‰æ­£å¼ç‰¹æ€§
cover: >-
  https://images.unsplash.com/photo-1727206407683-490abfe0d682?crop=entropy&cs=srgb&fm=jpg&ixid=M3wxOTcwMjR8MHwxfHJhbmRvbXx8fHx8fHx8fDE3Mzg4MzQ2Mzl8&ixlib=rb-4.0.3&q=85
coverY: 0
---

# Java18

## ğŸ“Œ Java 18 æ­£å¼ç‰¹æ€§æ€»ç»“è¡¨æ ¼

| **ç±»åˆ«**   | **æ–°ç‰¹æ€§**                  | **ä½œç”¨**                                              |
| -------- | ------------------------ | --------------------------------------------------- |
| **ç¼–ç è§„èŒƒ** | é»˜è®¤å­—ç¬¦é›† UTF-8ï¼ˆJEP 400ï¼‰     | ç»Ÿä¸€æ‰€æœ‰ Java å¹³å°çš„é»˜è®¤å­—ç¬¦é›†ä¸º UTF-8ï¼Œé¿å…è·¨å¹³å°ç¼–ç é—®é¢˜ï¼Œæé«˜ä¸€è‡´æ€§ã€‚          |
| **å¼€å‘å·¥å…·** | å†…ç½®ç®€æ˜“ Web æœåŠ¡å™¨ï¼ˆJEP 408ï¼‰    | æä¾› `jwebserver`ï¼Œå¯å¿«é€Ÿå¯åŠ¨é™æ€ Web æœåŠ¡å™¨ï¼Œä¾¿äºå¼€å‘æµ‹è¯•ã€‚             |
| **æ–‡æ¡£ä¼˜åŒ–** | Java API æ–‡æ¡£ä»£ç ç‰‡æ®µï¼ˆJEP 413ï¼‰ | Javadoc æ–°å¢ `@snippet`ï¼Œæå‡ä»£ç ç¤ºä¾‹çš„å¯è¯»æ€§å’Œç»´æŠ¤æ€§ã€‚               |
| **åå°„ä¼˜åŒ–** | æ–¹æ³•å¥æŸ„ä¼˜åŒ–åå°„æœºåˆ¶ï¼ˆJEP 416ï¼‰      | ä½¿ç”¨ `MethodHandle` é‡æ–°å®ç° `java.lang.reflect`ï¼Œæé«˜æ€§èƒ½ã€‚    |
| **å®‰å…¨æ€§**  | å¼ƒç”¨ç»ˆç»“å™¨ï¼ˆJEP 421ï¼‰           | è®¡åˆ’ç§»é™¤ `finalize()`ï¼Œé¼“åŠ±ä½¿ç”¨ `try-with-resources` è¿›è¡Œèµ„æºç®¡ç†ã€‚ |

## 1.JEP 400ï¼šé»˜è®¤å­—ç¬¦é›† UTF-8

### ä½œç”¨

* ç»Ÿä¸€æ‰€æœ‰ Java å¹³å°çš„é»˜è®¤å­—ç¬¦é›†ä¸º UTF-8ï¼Œé¿å…å› ä¸åŒæ“ä½œç³»ç»Ÿé»˜è®¤ç¼–ç ä¸åŒè€Œå¯¼è‡´çš„å…¼å®¹æ€§é—®é¢˜ã€‚

### ä»£ç ç¤ºä¾‹

```java
// Java 18 ä¹‹å‰ï¼Œé»˜è®¤å­—ç¬¦é›†ä¾èµ–äºæ“ä½œç³»ç»Ÿ
System.out.println(Charset.defaultCharset()); // Windows å¯èƒ½æ˜¯ GBKï¼ŒLinux/macOS å¯èƒ½æ˜¯ UTF-8

// Java 18 ä¹‹åï¼Œé»˜è®¤å­—ç¬¦é›†å›ºå®šä¸º UTF-8
```

âš ï¸ å½±å“

* ä»¥å‰åœ¨ Windows ä¸Šè¿è¡Œ Java ä»£ç æ—¶ï¼Œé»˜è®¤ç¼–ç å¯èƒ½æ˜¯ GBKï¼Œä½†åœ¨ Java 18 ä¹‹åï¼Œå…¨éƒ¨å˜æˆ UTF-8ï¼Œå¯èƒ½ä¼šå½±å“è¯»å–æ—§æ–‡ä»¶çš„ä»£ç ã€‚

## 2.JEP 408ï¼šå†…ç½®ç®€æ˜“ Web æœåŠ¡å™¨

### ä½œç”¨

* æä¾›ä¸€ä¸ªå†…ç½®çš„é™æ€ Web æœåŠ¡å™¨ï¼Œé€‚ç”¨äºå‰ç«¯å¼€å‘ã€API è°ƒè¯•ç­‰å¿«é€Ÿæµ‹è¯•åœºæ™¯ã€‚

### ä»£ç ç¤ºä¾‹

```sh
# å¯åŠ¨é»˜è®¤ Web æœåŠ¡å™¨ï¼ˆç›‘å¬ 8000 ç«¯å£ï¼‰
jwebserver

# æŒ‡å®šæœåŠ¡å™¨æ ¹ç›®å½•å’Œç«¯å£
jwebserver -d /home/user/public_html -p 8080
```

âš ï¸ é™åˆ¶

* ä»…æ”¯æŒé™æ€æ–‡ä»¶ï¼Œä¸æ”¯æŒ CGIã€Servlet æˆ–å…¶ä»–åŠ¨æ€ Web æŠ€æœ¯ã€‚

## 3.JEP 413ï¼šJava API æ–‡æ¡£ä»£ç ç‰‡æ®µ

### ä½œç”¨

* æå‡ Javadoc ä»£ç ç¤ºä¾‹çš„å¯è¯»æ€§ï¼Œæ”¯æŒ @snippet æ ‡ç­¾ã€‚

### ä»£ç ç¤ºä¾‹

```java
/**
 * ç¤ºä¾‹æ–¹æ³•å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ {@code Optional.isPresent}ï¼š
 * {@snippet :
 * if (v.isPresent()) {
 *     System.out.println("Value: " + v.get());
 * }
 * }
 */
public void exampleMethod() {
    // æ–¹æ³•å®ç°
}
```

âš ï¸ é€‚ç”¨åœºæ™¯

* æå‡ Java API æ–‡æ¡£è´¨é‡ï¼Œæ–¹ä¾¿å¼€å‘è€…é˜…è¯»ç¤ºä¾‹ä»£ç ã€‚

## 4.JEP 416ï¼šæ–¹æ³•å¥æŸ„ä¼˜åŒ–åå°„æœºåˆ¶

### ä½œç”¨

* æå‡ java.lang.reflect åå°„ API çš„æ€§èƒ½ï¼Œæ”¹ä¸ºåŸºäº MethodHandle å®ç°ã€‚

### ä»£ç ç¤ºä¾‹

```java
Method method = MyClass.class.getMethod("hello");
MethodHandle handle = MethodHandles.lookup().unreflect(method);
handle.invokeExact(new MyClass()); // æ›´é«˜æ•ˆçš„åå°„è°ƒç”¨
```

âš ï¸ å½±å“

* å‡å°‘åå°„è°ƒç”¨çš„å¼€é”€ï¼Œå¯¹æ¡†æ¶ï¼ˆå¦‚ Springã€Hibernateï¼‰æ€§èƒ½ä¼˜åŒ–æœ‰å¸®åŠ©ã€‚



## 5.JEP 421ï¼šå¼ƒç”¨ç»ˆç»“å™¨

### ä½œç”¨

* è®¡åˆ’ç§»é™¤ finalize() æ–¹æ³•ï¼Œé¼“åŠ±ä½¿ç”¨ try-with-resources æ¥è¿›è¡Œèµ„æºç®¡ç†ã€‚

### ä»£ç ç¤ºä¾‹

```java
// Java 18 ä¹‹å‰ï¼ˆä¸æ¨èï¼‰
@Override
protected void finalize() throws Throwable {
    System.out.println("Finalizer is called!");
}

// Java 18 ä¹‹åï¼ˆæ¨èä½¿ç”¨ try-with-resourcesï¼‰
try (BufferedReader reader = new BufferedReader(new FileReader("test.txt"))) {
    System.out.println(reader.readLine());
} // èµ„æºè‡ªåŠ¨å…³é—­
```







