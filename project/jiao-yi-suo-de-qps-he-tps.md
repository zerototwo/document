---
cover: >-
  https://images.unsplash.com/photo-1736329279938-372e9e471795?crop=entropy&cs=srgb&fm=jpg&ixid=M3wxOTcwMjR8MHwxfHJhbmRvbXx8fHx8fHx8fDE3NDExMjExNTV8&ixlib=rb-4.0.3&q=85
coverY: 0
---

# 交易所的 QPS 和 TPS

在估算 QPS 和 TPS 时，我们需要考虑 交易所的用户量、交易活跃度、订单撮合效率、查询请求比例 等因素。

## 1.交易所规模假设

假设一个 小型数字货币交易所 具有以下特性：

• 日活用户（DAU）：10 万

• 并发在线用户：1,000 \~ 10,000

• 高峰时段下单用户占比：10%

• 下单频率：每个活跃用户每秒 0.1 \~ 1 笔交易

• 市场数据查询（行情查询、K 线图等）：所有用户每秒查询 1 \~ 5 次

• 撮合成功率：80%（有些订单可能不会立即成交）

## 2.计算 TPS（交易撮合数）

🔹 TPS 计算公式

🔢 计算

假设：

• 高峰时段 5,000 人在线，其中 500 人（10%）在下单

• 每个用户每秒 下单 0.2 笔

• 撮合成功率 80%



✅ 小型交易所的 TPS 估算

• 低估值（冷门时段）：10 \~ 20 TPS

• 高峰值（交易活跃时段）：50 \~ 200 TPS

• 大行情波动（极端情况）：可达 500 TPS

## 3.计算 QPS（查询数）

🔹 QPS 计算公式\


🔢 计算

假设：

• 在线用户 5,000 人

• 每个用户平均每秒执行 2 次查询（包括行情查询、订单查询、资产查询）

✅ 小型交易所的 QPS 估算

• 低估值（冷门时段）：5,000 QPS

• 高峰值（交易活跃时段）：10,000 \~ 50,000 QPS

• 大行情波动（极端情况）：100,000 QPS+

## 4.交易所 QPS/TPS 关系

在交易所中，QPS 远高于 TPS：

• 每次下单（TPS）会产生 多个查询请求（如行情查询、余额查询、订单状态查询）。

• 通常 QPS ≈ 100 × TPS，即每笔交易会触发 100 次查询（订单、余额、行情等）。\


💡 典型交易所 QPS/TPS 比例

| 交易所规模             | TPS（交易笔数/秒）      | QPS（查询数/秒）             | QPS/TPS 比例 |
| ----------------- | ---------------- | ---------------------- | ---------- |
| 小型交易所             | 50 \~ 200 TPS    | 10,000 \~ 50,000 QPS   | 100:1      |
| 中型交易所             | 500 \~ 5,000 TPS | 100,000 \~ 500,000 QPS | 100:1      |
| 大型交易所（Binance 级别） | 50,000+ TPS      | 10,000,000+ QPS        | 200:1      |

## 5.如何优化 QPS & TPS

🎯 QPS 优化（降低数据库压力）

• Redis 缓存：将行情数据、K 线图等存入 Redis，减少数据库查询。

• API 网关限流：防止恶意爬取行情数据，保护数据库。

• 读写分离：数据库读请求走从库，提高查询吞吐量。

🎯 TPS 优化（提高撮合性能）

• 高效撮合引擎（跳表/红黑树）：提高撮合速度，减少锁竞争。

• 无锁架构（Disruptor）：提升撮合引擎吞吐量。

• 异步持久化（Kafka + MySQL）：撮合完成后异步写数据库，减少交易延迟。

## 总结

| 交易所规模 | TPS（交易撮合/秒）  | QPS（查询/秒）          |
| ----- | ------------ | ------------------ |
| 小型交易所 | 50 \~ 200    | 10,000 \~ 50,000   |
| 中型交易所 | 500 \~ 5,000 | 100,000 \~ 500,000 |
| 大型交易所 | 50,000+      | 10,000,000+        |

• QPS 远高于 TPS（100 倍以上），因为每笔交易会触发多个查询请求。

• 优化方向：QPS 需要缓存 + 限流，TPS 需要高效撮合引擎 + 异步架构。

