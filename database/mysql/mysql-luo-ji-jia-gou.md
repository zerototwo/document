---
description: MySQL 的逻辑架构可以分为 连接层、管理层、存储引擎层 三大部分，整体结构如下
---

# MySQL逻辑架构



<figure><img src="../../.gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

## 1.客户端连接层

* 连接管理：负责建立数据库连接。
* 权限认证：检查用户权限，决定是否允许执行 SQL 语句。

## 2.查询处理层

### 查询缓存

* 查询缓存 作用是 直接返回已执行过的 SQL 结果，但 MySQL 8.0 已移除此功能，因为缓存命中率不高。

### 解析器（SQL Parser）

* 对 SQL 进行 词法分析、语法分析，检查 SQL 是否正确。

### 优化器（Optimizer）

* 选择最优执行计划（索引选择、连接顺序等）

### 执行器（Executor）

* 按照优化器的执行计划，逐步执行 SQL

## 3.存储引擎层

MySQL 提供多种存储引擎，最常用的是 InnoDB。

* InnoDB：支持事务（ACID）、行级锁、高并发、MVCC
* MyISAM：不支持事务，查询速度快，但不安全
* Memory：数据存储在内存中，速度快但重启丢失数据

## 4.物理存储层

数据文件：存储实际的表数据（如 .ibd 文件）。

### 日志文件

* Redo Log（重做日志）：保证事务持久性。
* Undo Log（回滚日志）：用于事务回滚。
* Binlog（归档日志）：用于 主从复制、数据恢复。

## 5.MySQL 逻辑架构运行流程

1. 客户端发送 SQL 语句（SELECT \* FROM users WHERE id=1）。
2. 连接管理模块接收请求，进行 权限认证。
3. 查询缓存检查 是否命中，如果命中 直接返回结果（MySQL 8.0 移除了）。
4. 查询解析器（SQL Parser） 解析 SQL 语法，转换成内部结构。
5. 优化器（Optimizer） 选择最优执行计划（索引选择、表连接顺序等）。
6. 执行器（Executor） 按照计划执行 SQL，调用存储引擎。
7. 存储引擎（如 InnoDB）读取/写入数据，并更新 日志文件。
8. 查询结果返回客户端。





